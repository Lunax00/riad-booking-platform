spring:
  application:
    name: user-service

server:
  port: ${SERVER_PORT:8081}
  shutdown: graceful

spring.lifecycle.timeout-per-shutdown-phase: 30s

# Database Configuration (externalized for Kubernetes)
spring.datasource:
  url: ${DATABASE_URL:jdbc:postgresql://localhost:5432/riad_db}
  username: ${DATABASE_USERNAME:riad_user}
  password: ${DATABASE_PASSWORD:riad_password}
  driver-class-name: org.postgresql.Driver

spring.jpa:
  hibernate:
    ddl-auto: ${JPA_DDL_AUTO:update}
  show-sql: false
  properties:
    hibernate:
      dialect: org.hibernate.dialect.PostgreSQLDialect
      format_sql: true

# Security OAuth2 Configuration
spring.security.oauth2.resourceserver.jwt:
  issuer-uri: ${KEYCLOAK_ISSUER_URI:http://localhost:8080/realms/riad}
  jwk-set-uri: ${KEYCLOAK_JWK_SET_URI:http://localhost:8080/realms/riad/protocol/openid-connect/certs}

# Actuator Configuration for Kubernetes
management:
  endpoints:
    web:
      exposure:
        include: health,prometheus,info,metrics
  endpoint:
    health:
      show-details: always
      probes:
        enabled: true
  health:
    livenessState:
      enabled: true
    readinessState:
      enabled: true

# Logging Configuration
logging:
  level:
    root: INFO
    ma.lunaire: ${LOG_LEVEL:DEBUG}
    org.springframework.security: INFO
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} - %logger{36} - %msg%n"